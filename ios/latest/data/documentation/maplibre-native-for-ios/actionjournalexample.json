{"schemaVersion":{"major":0,"minor":3,"patch":0},"metadata":{"role":"article","roleHeading":"Article","modules":[{"name":"MapLibre"}],"title":"Action Journal"},"variants":[{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/maplibre-native-for-ios\/actionjournalexample"]}],"sections":[],"seeAlsoSections":[{"identifiers":["doc:\/\/org.swift.MyProject\/documentation\/MapLibre-Native-for-iOS\/ObserverExample"],"anchor":"Observability","title":"Observability","generated":true}],"primaryContentSections":[{"kind":"content","content":[{"type":"paragraph","inlineContent":[{"text":"The Action Journal provides functionality for persistent logging of top level map events.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Its primary use case is to assist in debugging problematic sessions and crashes by offering additional insight into the actions performed by the map at the time of failure. Data is stored in human readable format, which is useful for analyzing individual cases, but can also be easily translated and aggregated into a database, allowing for efficient analysis of multiple cases and helping to identify recurring patterns (Google BigQuery, AWS Glue + S3 + Athena, etc).","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"We are always interested in improving observability, so if you have a special use case, feel free to "},{"identifier":"https:\/\/github.com\/maplibre\/maplibre-native","type":"reference","isActive":true},{"type":"text","text":" to extend the types of observability methods."}]},{"level":2,"text":"Logging implementation details","type":"heading","anchor":"Logging-implementation-details"},{"type":"paragraph","inlineContent":[{"text":"The logging is implemented using rolling files with a size based policy:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"A new file is created when the current log size exceeds ","type":"text"},{"type":"reference","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions\/logFileSize","isActive":true},{"text":".","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"When the maximum number of files exceeds ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions\/logFileCount"},{"text":":","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"The oldest one is deleted.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The remaining files are renamed sequentially to maintain the naming convention "},{"type":"codeVoice","code":"action_journal.0.log"},{"type":"text","text":" through "},{"type":"codeVoice","code":"action_journal.{logFileCount - 1}.log"},{"type":"text","text":"."}]}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Each file contains one event per line.","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"All files are stored in an umbrella “action_journal” directory at "},{"type":"reference","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions\/path","isActive":true},{"type":"text","text":"."}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"See also: "},{"type":"reference","isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNSettings"},{"type":"text","text":", "},{"type":"reference","isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions"},{"type":"text","text":"."}]},{"level":2,"text":"Event format","type":"heading","anchor":"Event-format"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Events are stored as JSON objects with the following format:"}]},{"alignments":["left","center","center","left"],"header":"row","type":"table","rows":[[[{"inlineContent":[{"type":"text","text":"Field"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Type"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Required","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"name","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"string","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"true"}],"type":"paragraph"}],[{"inlineContent":[{"text":"event name","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"time","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"string"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"true"}],"type":"paragraph"}],[{"inlineContent":[{"text":"event time (","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/en.wikipedia.org\/wiki\/ISO_8601"},{"text":" with milliseconds)","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"styleName","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"string","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"false","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"currently loaded style name"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"styleURL"}],"type":"paragraph"}],[{"inlineContent":[{"text":"string","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"false","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"currently loaded style URL"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"clientName","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"string","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"false","type":"text"}],"type":"paragraph"}],[{"inlineContent":[],"type":"paragraph"}]],[[{"inlineContent":[{"text":"clientVersion","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"string","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"false"}],"type":"paragraph"}],[{"inlineContent":[],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"event"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"object"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"false"}],"type":"paragraph"}],[{"inlineContent":[{"text":"event specific data - consists of encoded values of the parameters passed to their ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapViewDelegate"},{"text":" counterparts","type":"text"}],"type":"paragraph"}]]]},{"code":["{","    \"name\" : \"onTileAction\",","    \"time\" : \"2025-04-17T13:13:13.974Z\",","    \"styleName\" : \"Streets\",","    \"styleURL\" : \"maptiler:\/\/maps\/streets\",","    \"clientName\" : \"App\",","    \"clientVersion\" : \"1.0\",","    \"event\" : {","        \"action\" : \"RequestedFromNetwork\",","        \"tileX\" : 0,","        \"tileY\" : 0,","        \"tileZ\" : 0,","        \"overscaledZ\" : 0,","        \"sourceID\" : \"openmaptiles\"","    }","}"],"syntax":null,"type":"codeListing"},{"anchor":"Usage","text":"Usage","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Enabling the action journal."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["let options = MLNMapOptions()","        options.actionJournalOptions.enabled = true","        options.styleURL = AMERICANA_STYLE","        mapView = MLNMapView(frame: view.bounds, options: options)"]},{"syntax":"swift","type":"codeListing","code":["@objc func printActionJournal() {","        print(\"ActionJournalLog files: \\(mapView.getActionJournalLogFiles())\")","        print(\"ActionJournalLog : \\(mapView.getActionJournalLog())\")","        \/\/ print only the newest events on each call","        mapView.clearActionJournalLog()","    }"]},{"anchor":"Alternative","text":"Alternative","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"The implementation is kept close to the core events to minimize additional locking and avoid platform-specific conversions and calls. As a result customization options and extensibility is limited."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"For greater flexibility, consider using the "},{"type":"reference","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapViewDelegate","isActive":true},{"type":"text","text":" interface. It provides hooks for most Action Journal events and allows for more customizable querying and storage of map data. However, this comes at the cost of added complexity. See "},{"type":"reference","identifier":".\/ObserverExample.md","isActive":true},{"type":"text","text":" to learn about the map events that you can listen for, which mirror the events available in the action journal."}],"type":"paragraph"}]}],"identifier":{"interfaceLanguage":"occ","url":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre-Native-for-iOS\/ActionJournalExample"},"hierarchy":{"paths":[["doc:\/\/org.swift.MyProject\/documentation\/MapLibre"]]},"kind":"article","abstract":[{"type":"text","text":"Learn about the "},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapView","isActive":true,"type":"reference"},{"type":"text","text":" methods for logging and viewing map actions."}],"references":{"doc://org.swift.MyProject/documentation/MapLibre/MLNSettings":{"url":"\/documentation\/maplibre\/mlnsettings","kind":"symbol","title":"MLNSettings","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNSettings","type":"topic","abstract":[{"text":"The ","type":"text"},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNSettings","type":"reference","isActive":true},{"text":" object provides a global way to set SDK properties such","type":"text"},{"text":" ","type":"text"},{"text":"as apiKey, backend URL, etc.","type":"text"}],"fragments":[{"text":"MLNSettings","kind":"identifier"}],"role":"symbol"},"./ObserverExample.md":{"identifier":".\/ObserverExample.md","title":"Observe Low-Level Events","titleInlineContent":[{"text":"Observe Low-Level Events","type":"text"}],"url":".\/ObserverExample.md","type":"link"},"doc://org.swift.MyProject/documentation/MapLibre":{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre","url":"\/documentation\/maplibre","title":"MapLibre","role":"collection","kind":"symbol","abstract":[{"type":"text","text":"Powerful, free and open-source mapping toolkit with full control over data sources and styling."}],"type":"topic"},"doc://org.swift.MyProject/documentation/MapLibre/MLNMapView":{"kind":"symbol","url":"\/documentation\/maplibre\/mlnmapview","type":"topic","title":"MLNMapView","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapView","role":"symbol","abstract":[{"text":"An interactive, customizable map view with an interface similar to the one","type":"text"},{"text":" ","type":"text"},{"text":"provided by Apple’s MapKit.","type":"text"}],"fragments":[{"text":"MLNMapView","kind":"identifier"}]},"doc://org.swift.MyProject/documentation/MapLibre/MLNActionJournalOptions/logFileCount":{"fragments":[{"kind":"identifier","text":"logFileCount"}],"abstract":[{"type":"text","text":"Maximum number of log files"}],"url":"\/documentation\/maplibre\/mlnactionjournaloptions\/logfilecount","type":"topic","title":"logFileCount","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions\/logFileCount","kind":"symbol","role":"symbol"},"doc://org.swift.MyProject/documentation/MapLibre/MLNActionJournalOptions/logFileSize":{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions\/logFileSize","kind":"symbol","abstract":[{"text":"Log file size (total journal size is equal to ","type":"text"},{"code":"logFileSize * logFileCount","type":"codeVoice"},{"text":")","type":"text"}],"type":"topic","url":"\/documentation\/maplibre\/mlnactionjournaloptions\/logfilesize","title":"logFileSize","role":"symbol","fragments":[{"kind":"identifier","text":"logFileSize"}]},"doc://org.swift.MyProject/documentation/MapLibre/MLNActionJournalOptions":{"url":"\/documentation\/maplibre\/mlnactionjournaloptions","role":"symbol","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions","kind":"symbol","type":"topic","fragments":[{"text":"MLNActionJournalOptions","kind":"identifier"}],"title":"MLNActionJournalOptions","abstract":[{"text":"The ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions"},{"text":" defines action journal properties such as path, log size, etc…","type":"text"}]},"doc://org.swift.MyProject/documentation/MapLibre-Native-for-iOS/ObserverExample":{"role":"article","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre-Native-for-iOS\/ObserverExample","url":"\/documentation\/maplibre-native-for-ios\/observerexample","type":"topic","kind":"article","title":"Observe Low-Level Events","abstract":[{"text":"Learn about the ","type":"text"},{"isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapViewDelegate","type":"reference"},{"text":" methods for observing map events.","type":"text"}]},"doc://org.swift.MyProject/documentation/MapLibre/MLNMapViewDelegate":{"title":"MLNMapViewDelegate","type":"topic","fragments":[{"text":"MLNMapViewDelegate","kind":"identifier"}],"role":"symbol","kind":"symbol","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapViewDelegate","url":"\/documentation\/maplibre\/mlnmapviewdelegate","abstract":[{"text":"The ","type":"text"},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapViewDelegate","type":"reference","isActive":true},{"text":" protocol defines a set of optional methods that you","type":"text"},{"text":" ","type":"text"},{"text":"can use to receive map-related update messages. Because many map operations","type":"text"},{"text":" ","type":"text"},{"text":"require the ","type":"text"},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNMapView","type":"reference","isActive":true},{"text":" class to load data asynchronously, the map view calls","type":"text"},{"text":" ","type":"text"},{"text":"these methods to notify your application when specific operations complete. The","type":"text"},{"text":" ","type":"text"},{"text":"map view also uses these methods to request information about annotations","type":"text"},{"text":" ","type":"text"},{"text":"displayed on the map, such as the styles and interaction modes to apply to","type":"text"},{"text":" ","type":"text"},{"text":"individual annotations.","type":"text"}]},"doc://org.swift.MyProject/documentation/MapLibre/MLNActionJournalOptions/path":{"type":"topic","url":"\/documentation\/maplibre\/mlnactionjournaloptions\/path","title":"path","fragments":[{"kind":"identifier","text":"path"}],"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNActionJournalOptions\/path","kind":"symbol","abstract":[{"text":"Local file path.","type":"text"}],"role":"symbol"},"https://github.com/maplibre/maplibre-native":{"identifier":"https:\/\/github.com\/maplibre\/maplibre-native","title":"open an issue or pull request","titleInlineContent":[{"type":"text","text":"open an issue or pull request"}],"url":"https:\/\/github.com\/maplibre\/maplibre-native","type":"link"},"https://en.wikipedia.org/wiki/ISO_8601":{"identifier":"https:\/\/en.wikipedia.org\/wiki\/ISO_8601","title":"ISO 8601","titleInlineContent":[{"text":"ISO 8601","type":"text"}],"url":"https:\/\/en.wikipedia.org\/wiki\/ISO_8601","type":"link"}}}