set(MLT_WITH_JSON OFF CACHE BOOL "No JSON support" FORCE)
set(MLT_WITH_PROTOZERO OFF CACHE BOOL "No protozero" FORCE)
set(MLT_WITH_FASTPFOR ON CACHE BOOL "Enabled" FORCE)
set(MLT_WITH_TESTS OFF CACHE BOOL "Google Test conflicts with Dawn")
set(MLT_WITH_TOOLS OFF CACHE BOOL "Not used")

# This is set by the platform CMakeLists.txt after vendor libraries.  If it was set earlier, we could just use it.
set(CMAKE_OSX_DEPLOYMENT_TARGET 14.3)
set(MLT_OSX_DEPLOYMENT_TARGET ${CMAKE_OSX_DEPLOYMENT_TARGET} CACHE STRING "Inherited MacOS/iOS target" FORCE)

string(REPLACE ";" " " TEMP "${CMAKE_CXX_COMPILER_PREDEFINES_COMMAND}")
message(STATUS "Clang predefines command: ${TEMP}")

execute_process(COMMAND bash -c "${TEMP}" OUTPUT_VARIABLE CLANG_DEFINES ERROR_VARIABLE CLANG_DEFINES_ERR OUTPUT_STRIP_TRAILING_WHITESPACE ERROR_STRIP_TRAILING_WHITESPACE)
message(STATUS "Clang defines: ${CLANG_DEFINES}")
message(STATUS "Clang errors: ${CLANG_DEFINES_ERR}")
execute_process(COMMAND cmd /c "${TEMP}" OUTPUT_VARIABLE CLANG_DEFINES ERROR_VARIABLE CLANG_DEFINES_ERR OUTPUT_STRIP_TRAILING_WHITESPACE ERROR_STRIP_TRAILING_WHITESPACE)
message(STATUS "Clang defines: ${CLANG_DEFINES}")
message(STATUS "Clang errors: ${CLANG_DEFINES_ERR}")

add_subdirectory(${PROJECT_SOURCE_DIR}/vendor/maplibre-tile-spec/cpp SYSTEM)
